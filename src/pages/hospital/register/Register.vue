<template>
    <div class="container">
        <div class="top">
            <span class="title">{{ detaileStore.hospitalInfo.hospital?.hosname || '医院名称' }}</span>
            <div class="level">
                <svg t="1721355257881" class="icon" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="4344" width="20" height="20">
                    <path
                        d="M986.776992 567.822977c14.823998-20.164492 26.251363-53.121973 26.251363-80.628234l-0.005126-0.396769c-0.793539-33.226095-16.845778-63.097593-45.19684-84.109961-27.883551-20.66276-65.458729-31.586731-108.666597-31.586731l-193.845887 0.035884c13.63369-47.042278 19.597532-100.589727 16.884737-153.311855-3.187482-61.967775-18.131433-117.13921-42.078049-155.35209-14.143236-22.563562-31.094614-39.332446-50.386623-49.84632-15.361225-8.370089-31.741542-12.615623-48.684719-12.615623-40.095228 0-69.546376 17.842315-85.168013 51.599486-12.649456 27.335045-12.649456 58.461442-12.649456 68.689272 0 87.236954-12.45671 124.689104-26.40925 158.056683-5.289232 9.781849-25.35735 33.24455-52.993818 54.16157-42.611175 32.246988-75.971578 39.017696-96.453895 39.017696l-144.089789 0c-28.828825 0-54.736732 10.680988-74.920703 30.886489-24.298274 24.323905-37.658223 60.185901-37.616188 100.983421l0.001025 0.760731 37.470604 403.396456c5.418413 73.995933 44.717026 114.76372 110.666847 114.797553 1.653718 0.015379 30.607623 0.277841 52.215658 0.277841 9.071356 0 21.437844-0.050237 28.841128-0.286043 23.031073-0.741251 40.783166-14.195523 55.04738-25.005692l3.624236-2.746628c3.47045-2.634876 7.958966-6.041761 10.787613-7.636014 2.294495 1.091884 5.393807 2.642053 8.07892 3.985122 7.318189 3.659094 17.340971 8.671511 28.261866 13.410187 26.117056 11.345346 63.949571 18.675838 96.383153 18.675838l301.476988 0c52.890268 0 94.037395-10.262689 122.299261-30.502023 28.652483-20.521276 43.815837-51.370857 43.850695-89.232079 0-13.623437-1.938736-24.567913-6.667159-35.454975 43.295013-16.846803 68.504728-49.618716 68.504728-90.56592 0-12.039436-3.257199-29.931988-10.07712-44.407402 8.743278-5.93206 17.574726-13.918707 25.344022-23.122319 17.040574-20.195249 26.414377-43.389335 26.394897-65.296741C1013.252884 612.426201 1004.16615 586.322473 986.776992 567.822977zM898.799812 682.726131l-22.270342 0 0.867356 65.362357 10.402122 4.070217 0.652055 0.250159c2.81942 1.074455 9.421989 3.590403 9.443519 23.428867-0.003076 3.403809-0.013328 13.764921-17.867946 22.567663-12.408524 6.119679-29.918659 9.630113-48.03984 9.630113l0 16.596644-16.480791-0.300396-0.890937 49.09174 13.114916 3.020368c2.600018 0.597717 8.008178 1.844413 7.987673 22.898816 0 14.763508-5.644991 25.403486-17.764396 33.482406-15.499633 10.33343-41.546972 15.794903-75.326699 15.794903l-312.100562 0c-11.539117 0-39.494435-7.971269-55.394938-15.796954-12.397246-6.097124-30.751157-16.439781-42.716775-23.214591L332.414226 434.134285c79.007324-27.16588 141.153491-95.435828 157.733731-127.879662l0.515698-1.108288c17.754144-42.137513 28.033236-86.674096 28.033236-189.634186 0-23.078234 4.3132-31.47908 6.883486-34.434857 1.481477-1.70293 3.771871-3.519661 12.246535-3.519661 8.443906 0 29.934038 13.505534 41.185061 31.451399 17.690579 28.219831 28.858557 74.782295 29.875599 124.554797 1.131869 55.389812-9.924358 110.039398-31.130497 153.878815l-0.776109 1.603481-13.6788 56.714427 297.271438-0.08612c50.690095 2.967055 78.121513 23.267904 78.325537 41.003593l-0.334229 11.623187c-0.401895 8.203999-3.941036 25.086686-11.083909 31.145876-7.190034 6.095073-12.738652 7.413537-14.117605 7.659595l-15.564223-0.656156-0.431628 53.90731-0.08407 14.5195 14.371865 2.050487c5.081107 0.725872 13.84489 2.935272 17.052877 5.179531 7.080332 4.975507 11.026495 15.99175 10.556934 29.444997-0.191721 5.263601-5.72291 15.899478-15.925109 26.043238C912.253059 678.62003 902.404569 682.726131 898.799812 682.726131zM258.021524 445.685705l0 486.712879c-3.860042 2.816344-7.481203 5.49223-10.454409 7.730337-5.671648 4.275266-10.423652 7.30281-12.769409 8.567961-5.534265 0.12508-14.388269 0.18762-26.391821 0.18762-19.246898 0-41.302964-0.160963-52.736481-0.256311l-0.996537-0.008202c-14.407749 0-28.619676-16.649956-32.557636-38.020134l-37.277858-417.166503c0.341406-25.792054 19.877423-46.025237 37.907358-48.16492L258.021524 445.685705z"
                        p-id="4345" fill="#7f7f7f"></path>
                </svg>
                <span>{{ detaileStore.hospitalInfo.hospital?.param.hostypeString || '医院等级' }}</span>
            </div>
        </div>
        <div class="bottom">
            <img :src="`data:image/jpeg;base64,` + detaileStore.hospitalInfo.hospital?.logoData" alt="">
            <div>
                <h4>挂号规则：</h4>
                <div class="time">
                    <span>预约周期: {{ detaileStore.hospitalInfo.bookingRule?.cycle || '7天' }}</span>
                    <span>放号时间: {{ detaileStore.hospitalInfo.bookingRule?.releaseTime || '8:00' }}</span>
                    <span>停挂时间: {{ detaileStore.hospitalInfo.bookingRule?.stopTime || '18:00' }}</span>
                </div>
                <div>具体地址:{{ detaileStore.hospitalInfo.hospital?.param.fullAddress || '具体地址' }}</div>
                <div>规划路线:{{ detaileStore.hospitalInfo.hospital?.route || '乘车路线' }}</div>
                <div>退号时间:{{ detaileStore.hospitalInfo.bookingRule?.quitTime || '15:00' }}</div>
                <h4>医院预约规则：</h4>
                <div class="rule" v-for="(item, index) in detaileStore.hospitalInfo.bookingRule?.rule" :key="index">
                    {{ item }}
                </div>
            </div>
        </div>
        <!-- 科室展示区  detaileStore.hospitalDepartmentInfo-->
        <div class="department">
            <div class="dep-left">
                <ul>
                    <li :class="{
                        active: index === currentIndex
                    }" @click="changeIndex(index)" v-for="(dep, index) in detaileStore.hospitalDepartmentInfo"
                        :key="dep.depcode">{{
                            dep.depname }}</li>
                </ul>
            </div>
            <div class="dep-right">
                <div class="showDepartment" v-for="dep in detaileStore.hospitalDepartmentInfo" :key="dep.depcode">
                    <div class="cur">{{ dep.depname }}</div>
                    <ul>
                        <li v-for="item in dep.children" :key="item.depcode" @click="toLogin(item)">
                            {{ item.depname }}
                        </li>
                    </ul>
                </div>
                <!-- <div class="showDepartment" v-for="dep in arr" :key="dep.depcode">
                    <div class="cur">{{ dep.depname }}</div>
                    <ul>
                        <li v-for="item in dep.children" :key="item.depcode" @click="toLogin">
                            {{ item.depname }}
                        </li>
                    </ul>
                </div> -->
            </div>
        </div>
    </div>
</template>
<script setup lang="ts">
import useDetailStore from '@/store/modules/hospitalDetail';
import useUserStore from '@/store/modules/user';
import { ref } from 'vue';
import { useRouter, useRoute } from 'vue-router';
let $router = useRouter()
let $route = useRoute()

// const arr = [{ depcode: '100', depname: '外科', children: [{ depcode: '101', depname: '外科1', children: null }, { depcode: '101', depname: '外科2', children: null }, { depcode: '101', depname: '外科3', children: null }] },
// { depcode: '200', depname: '内科', children: [{ depcode: '201', depname: '内科1', children: null }, { depcode: '201', depname: '内科2', children: null }, { depcode: '201', depname: '内科3', children: null }] },
// { depcode: '300', depname: '神经科', children: [{ depcode: '301', depname: '神经科2', children: null }, { depcode: '301', depname: '神经科1', children: null }, { depcode: '301', depname: '神经科3', children: null }] }]
let detaileStore = useDetailStore()
let userStore = useUserStore()
//控制科室高亮情况
let currentIndex = ref<number>(0)
//点击li标签修改索引值
const changeIndex = (index: number) => {
    currentIndex.value = index
    //右边导航栏跳转功能  给右边每个大科室div起个类名cur
    let all = document.querySelectorAll('.cur')
    all[index].scrollIntoView({
        behavior: 'smooth', //丝滑滚动效果
        block: 'center'
    })
}
//登录
const toLogin = (item: any) => {
    //item 为用户选中的2级科室数据
    //跳转到详情页面
    $router.push({ path: '/hospital/register_detail', query: { hoscode: $route.query.hoscode, depcode: item.depcode } })

    // userStore.visiable = true
}
</script>
<style scoped>
.container {
    margin-top: 30px;
    width: 90%;
}

.department {
    margin-left: 40px;
    display: flex;
    /* background-color: red; */
    margin-top: 50px;
    gap: 10px;
    height: 700px;

}

.dep-left {
    width: 100px;
    height: 80%;
    overflow: auto;
}

.dep-left ul {
    list-style-type: none;
    display: flex;
    flex-direction: column;
    gap: 15px;
    background: white;
    font-size: 18px;
}

.dep-left li {
    line-height: 40px;
    width: 100%;
    text-align: center;
}



.showDepartment ul {
    list-style-type: none;
    display: flex;
    flex-wrap: wrap;


}

.showDepartment li {
    width: 33%;
    color: #7f7f7f;
    line-height: 30px;
}

.active {
    border-left: 3px solid #40a0ff80;
    color: #409eff;
    background: #EDF6FF;
}

.dep-right {
    flex: 1;
    height: 80%;
    overflow: auto;
}

.dep-right::-webkit-scrollbar {
    display: none;
}

.dep-left::-webkit-scrollbar {
    display: none;
}

.rule {
    margin-top: 20px;
}

.bottom div>div,
h4 {
    margin-bottom: 25px;
}

.time {
    display: flex;
    gap: 30px;
}

.bottom {
    margin-top: 30px;
    display: flex;
    margin-left: 40px;
    gap: 20px;
}

img {
    width: 70px;
    height: 70px;
    border-radius: 50%;
}

.title {
    font-size: 30px;
}

.level {
    display: flex;
    align-items: center;
    gap: 5px;
}

.top {
    margin-left: 20px;
    display: flex;
    gap: 30px;
    align-items: flex-end;
}
</style>
